import{j as i,c as a,b as n,ag as e}from"./chunks/framework.BlzMDYBM.js";const c=JSON.parse('{"title":"Cent OS configure","description":"","frontmatter":{},"headers":[],"relativePath":"linux/centos.md","filePath":"linux/centos.md","lastUpdated":1744879674000}'),l={name:"linux/centos.md"};function t(p,s,h,r,k,d){return n(),a("div",null,s[0]||(s[0]=[e(`<h1 id="cent-os-configure" tabindex="-1">Cent OS configure <a class="header-anchor" href="#cent-os-configure" aria-label="Permalink to &quot;Cent OS configure&quot;">​</a></h1><p>CentOS（Community Enterprise Operating System）是Linux发行版之一，它是來自於Red Hat Enterprise Linux（RHEL）依照開放原始碼規定釋出的原始碼所編譯而成。由於出自同樣的原始碼，因此有些要求高度穩定性的伺服器以CentOS替代商業版的Red Hat Enterprise Linux使用。兩者的不同，在於CentOS並不包含封闭原始碼軟體。CentOS 对上游代码的主要修改是为了移除不能自由使用的商标。2014年，CentOS宣布与Red Hat合作，但CentOS将会在新的委员会下继续运作，并不受RHEL的影响。</p><p><a href="https://centos.org/" target="_blank" rel="noreferrer">CentOS 官方网站</a></p><h2 id="java-install" tabindex="-1">Java install <a class="header-anchor" href="#java-install" aria-label="Permalink to &quot;Java install&quot;">​</a></h2><p>安装 <code>jdk</code></p><h3 id="installing-openjdk" tabindex="-1">Installing OpenJDK <a class="header-anchor" href="#installing-openjdk" aria-label="Permalink to &quot;Installing OpenJDK&quot;">​</a></h3><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span>// install jdk 8</span></span>
<span class="line"><span># yum install java-1.8.0-openjdk-devel</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// install jdk 11</span></span>
<span class="line"><span># yum install java-11-openjdk-devel</span></span>
<span class="line"><span></span></span>
<span class="line"><span>// show jdk version</span></span>
<span class="line"><span># java -version</span></span>
<span class="line"><span>openjdk version &quot;1.8.0_242&quot;</span></span>
<span class="line"><span>OpenJDK Runtime Environment (build 1.8.0_242-b08)</span></span>
<span class="line"><span>OpenJDK 64-Bit Server VM (build 25.242-b08, mixed mode)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="maven" tabindex="-1">Maven <a class="header-anchor" href="#maven" aria-label="Permalink to &quot;Maven&quot;">​</a></h2><h3 id="_1-download-apache-maven" tabindex="-1">1. Download Apache Maven <a class="header-anchor" href="#_1-download-apache-maven" aria-label="Permalink to &quot;1. Download Apache Maven&quot;">​</a></h3><p>At the time of writing this article, the latest version of Apache Maven is <code>3.6.3</code>. Check the <a href="https://maven.apache.org/download.cgi" target="_blank" rel="noreferrer">Maven download page</a> to see if a newer version is available.</p><p>Start by downloading the Apache Maven archive in the <code>/tmp</code> directory with <a href="https://linuxize.com/post/wget-command-examples/" target="_blank" rel="noreferrer"><code>wget</code></a> command:</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span>wget https://www-us.apache.org/dist/maven/maven-3/3.6.3/binaries/apache-maven-3.6.3-bin.tar.gz -P /tmp</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Once the download is complete, <a href="https://linuxize.com/post/how-to-create-and-extract-archives-using-the-tar-command-in-linux/" target="_blank" rel="noreferrer">extract the archive</a> in the <code>/opt</code> directory:</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span>sudo tar xf /tmp/apache-maven-3.6.3-bin.tar.gz -C /opt</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>To have more control over Maven versions and updates, we will <a href="https://linuxize.com/post/how-to-create-symbolic-links-in-linux-using-the-ln-command/" target="_blank" rel="noreferrer">create a symbolic link</a> <code>maven</code> that will point to the Maven installation directory:</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span>sudo ln -s /opt/apache-maven-3.6.3 /opt/maven</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_2-setup-environment-variables" tabindex="-1">2. Setup environment variables <a class="header-anchor" href="#_2-setup-environment-variables" aria-label="Permalink to &quot;2. Setup environment variables&quot;">​</a></h3><p>Next, we’ll need to set up the environment variables. Open your text editor and create a new file named <code>mavenenv.sh</code> in the <code>/etc/profile.d/</code> directory.</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span>sudo nano /etc/profile.d/maven.sh</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Paste the following code:</p><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#D73A49;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;"> JAVA_HOME</span><span style="--shiki-light:#D73A49;--shiki-dark:#D73A49;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">/usr/lib/jvm/jre-openjdk</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#D73A49;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;"> M2_HOME</span><span style="--shiki-light:#D73A49;--shiki-dark:#D73A49;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">/opt/maven</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#D73A49;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;"> MAVEN_HOME</span><span style="--shiki-light:#D73A49;--shiki-dark:#D73A49;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">/opt/maven</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#D73A49;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;"> PATH</span><span style="--shiki-light:#D73A49;--shiki-dark:#D73A49;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">\${M2_HOME}/bin:\${PATH}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>Save and close the file. The script will be sourced at shell startup.</p><p>Make the script executable by running the following <a href="https://linuxize.com/post/chmod-command-in-linux/" target="_blank" rel="noreferrer"><code>chmod</code></a> command:</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span>sudo chmod +x /etc/profile.d/maven.sh</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_3-verify-the-installation" tabindex="-1">3. Verify the installation <a class="header-anchor" href="#_3-verify-the-installation" aria-label="Permalink to &quot;3. Verify the installation&quot;">​</a></h3><p>To verify that Maven is installed, use the <code>mvn -version</code> command which will print the Maven version:</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span>mvn -version</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>You should see something like the following:</p><div class="language-output vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">output</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span>Apache Maven 3.6.3 (cecedd343002696d0abb50b32b541b8a6ba2883f)</span></span>
<span class="line"><span>Maven home: /opt/maven</span></span>
<span class="line"><span>Java version: 11.0.5, vendor: Oracle Corporation, runtime: /usr/lib/jvm/java-11-openjdk-11.0.5.10-0.el8_0.x86_64</span></span>
<span class="line"><span>Default locale: en_US, platform encoding: UTF-8</span></span>
<span class="line"><span>OS name: &quot;linux&quot;, version: &quot;4.18.0-80.7.1.el8_0.x86_64&quot;, arch: &quot;amd64&quot;, family: &quot;unix&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>That’s it. The latest version of Maven has been installed on your CentOS system.</p><h2 id="nodejs-install" tabindex="-1">Nodejs install <a class="header-anchor" href="#nodejs-install" aria-label="Permalink to &quot;Nodejs install&quot;">​</a></h2><p>安装 <code>node.js</code></p><p><a href="https://github.com/nvm-sh/nvm" target="_blank" rel="noreferrer">nvm-git</a></p><div class="language-she vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">she</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span>$ curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.35.3/install.sh | bash</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="python-install" tabindex="-1">python install <a class="header-anchor" href="#python-install" aria-label="Permalink to &quot;python install&quot;">​</a></h2><p>Installing Python 3 on CentOS 8</p><p>To install Python 3 on CentOS 8 run the following command as root or <a href="https://linuxize.com/post/how-to-add-user-to-sudoers-in-centos/" target="_blank" rel="noreferrer">sudo user</a> in your terminal:</p><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> dnf</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> python3</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>To verify the installation, check the <a href="https://linuxize.com/post/how-to-check-python-version/" target="_blank" rel="noreferrer">Python version</a> by typing:</p><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> python3</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> --version</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>At the time of writing this article, the latest version of Python 3 available in the CentOS repositories is “3.6.x”:</p><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">Python</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> 3.6.8</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="set-default-python-version-unversioned-python-command" tabindex="-1">Set Default Python Version (Unversioned Python Command) <a class="header-anchor" href="#set-default-python-version-unversioned-python-command" aria-label="Permalink to &quot;Set Default Python Version (Unversioned Python Command)&quot;">​</a></h2><p>If you have applications that expect to find the <code>python</code> command in the <a href="https://linuxize.com/post/how-to-add-directory-to-path-in-linux/" target="_blank" rel="noreferrer">system’s path</a>, you’ll need to create the unversioned python command and set the default version.</p><p>To set Python 3 as the system-wide unversioned python command, use the <code>alternatives</code> utility:</p><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> alternatives</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> python</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> /usr/bin/python3</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="配置ssl证书" tabindex="-1">配置SSl证书 <a class="header-anchor" href="#配置ssl证书" aria-label="Permalink to &quot;配置SSl证书&quot;">​</a></h2><p><code>certbot</code> 自动更新 <code>HTTPS</code> 证书, 安装好了 <code>Certbot</code> ，给网站安装好了 <code>SSL</code> 证书.</p><h3 id="install-ssl-letsencrypt-certificates" tabindex="-1">Install SSL Letsencrypt Certificates <a class="header-anchor" href="#install-ssl-letsencrypt-certificates" aria-label="Permalink to &quot;Install SSL Letsencrypt Certificates&quot;">​</a></h3><p>安装 <code>letsencrypt</code> 软件</p><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> letsencrypt</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> -y</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>如果启动 nginx 服务, 需要将它关掉, 再去生成新的证书.</p><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> sytemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> stop</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> nginx</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><code>dms.pub</code> 生成新的证书.</p><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">certbot</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> certonly</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> --rsa-key-size</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> 2048</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> --standalone</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> --agree-tos</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> --no-eff-email</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> --email</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> admin@dms.pub</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> dms.pub</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">or</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">certbot</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> certonly</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> --nginx</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> dms.pub</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>生成新的证书放在 <code>/etc/letsencrypt/live/</code> 目录下.</p><h3 id="nginx-配置文件" tabindex="-1">nginx 配置文件 <a class="header-anchor" href="#nginx-配置文件" aria-label="Permalink to &quot;nginx 配置文件&quot;">​</a></h3><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">server</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">	server_name</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> www.abc.com</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">	listen</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> 80</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#D73A49;">	return</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> 301</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> https://</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">$host$request_uri;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">server</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">	listen</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> 443</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">	ssl</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> on</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">	server_name</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> www.abc.com</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">    ssl_certificate</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> /etc/letsencrypt/live/www.abc.com/fullchain.pem</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">    ssl_certificate_key</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> /etc/letsencrypt/live/www.abc.com/privkey.pem</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">    ssl_session_timeout</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> 5m</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">    ssl_ciphers</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">    ssl_protocols</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> TLSv1</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> TLSv1.1</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> TLSv1.2</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">    ssl_prefer_server_ciphers</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> on</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">    location</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> /</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">        proxy_pass</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> http://127.0.0.1:8080</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">	}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="配置静态网站" tabindex="-1">配置静态网站 <a class="header-anchor" href="#配置静态网站" aria-label="Permalink to &quot;配置静态网站&quot;">​</a></h3><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">server</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">	listen</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> 80</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">	listen</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;"> [::]:80;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">	server_name</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> turingthink.site</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> www.turingthink.site</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#D73A49;">	return</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> 302</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> https://</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">$server_name$request_uri;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">server</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">	listen</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> 443</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> ssl</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> http2</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">	listen</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;"> [::]:443 ssl http2;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">	server_name</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> turingthink.site</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> www.turingthink.site</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">	gzip_vary</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;">                       on</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">	gzip_proxied</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;">                    any</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">	gzip_comp_level</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;">                 6</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">	gzip_buffers</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;">                    16</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> 8k</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">	gzip_http_version</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;">               1.1</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">	gzip_types</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;">                      text/plain</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> text/css</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> application/json</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> application/javascript</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> text/xml</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> application/xml</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> application/xml+rss</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> text/javascript</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">	ssl_certificate</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;">     /www/wwwroot/turingthink/cert/turingthink.pem</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">	ssl_certificate_key</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> /www/wwwroot/turingthink/cert/turingthink.key</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">	ssl_session_cache</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;">    shared:SSL:1m</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">	ssl_session_timeout</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;">  5m</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">	ssl_ciphers</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;">  HIGH:!aNULL:!MD5</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;"> 	ssl_protocols</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;">                   TLSv1.2</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> TLSv1.3</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;"> 	ssl_prefer_server_ciphers</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;">       on</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">	ssl_ecdh_curve</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;">                  secp384r1</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">	location</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> /</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">		root</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> /www/wwwroot/turingthink</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">		index</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> index.html</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">		# try_files $uri $uri/ =404;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">	}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">	location</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> ~</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;">*</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> ^.+</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;">\\.</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">jpg</span><span style="--shiki-light:#D73A49;--shiki-dark:#D73A49;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">jpeg</span><span style="--shiki-light:#D73A49;--shiki-dark:#D73A49;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">gif</span><span style="--shiki-light:#D73A49;--shiki-dark:#D73A49;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">png</span><span style="--shiki-light:#D73A49;--shiki-dark:#D73A49;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">ico</span><span style="--shiki-light:#D73A49;--shiki-dark:#D73A49;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">css</span><span style="--shiki-light:#D73A49;--shiki-dark:#D73A49;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">js</span><span style="--shiki-light:#D73A49;--shiki-dark:#D73A49;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">pdf</span><span style="--shiki-light:#D73A49;--shiki-dark:#D73A49;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">txt</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;">{</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">		root</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> /www/wwwroot/turingthink</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><h3 id="创建-cron-文件" tabindex="-1">创建 Cron 文件 <a class="header-anchor" href="#创建-cron-文件" aria-label="Permalink to &quot;创建 Cron 文件&quot;">​</a></h3><p>输入以下命令：</p><ol><li>查看crontab定时执行任务列表</li></ol><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> crontab</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> -l</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ol start="2"><li>添加crontab定时执行任务</li></ol><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> crontab</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> -e</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="添加编辑-certbot-的自动续期命令" tabindex="-1">添加编辑 Certbot 的自动续期命令 <a class="header-anchor" href="#添加编辑-certbot-的自动续期命令" aria-label="Permalink to &quot;添加编辑 Certbot 的自动续期命令&quot;">​</a></h3><p>在 root cron 文件中，复制以下代码，粘贴，保存，上传。</p><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">0</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> 1</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> 1</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> /usr/bin/certbot</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> renew</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> --renew-hook</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> &quot;/etc/init.d/nginx reload&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>以上含义是：每隔 7 天，夜里 3 点整自动执行检查续期命令一次。续期完成后，重启 nginx 服务。</p><h3 id="重启-cron-服务-使之生效" tabindex="-1">重启 Cron 服务，使之生效 <a class="header-anchor" href="#重启-cron-服务-使之生效" aria-label="Permalink to &quot;重启 Cron 服务，使之生效&quot;">​</a></h3><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> cron.service</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>重启之后，一切搞定！</p><h3 id="想手动尝试-certbot-证书更新" tabindex="-1">想手动尝试 Certbot 证书更新？ <a class="header-anchor" href="#想手动尝试-certbot-证书更新" aria-label="Permalink to &quot;想手动尝试 Certbot 证书更新？&quot;">​</a></h3><p>一般是直接使用 renew 命令，即：</p><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> /usr/bin/certbot</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> renew</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>但是现在 Certbot 也会自己判断了，没有快到期之前，它也觉得没必要频繁续期。所以看看我们手动去续期的结果：</p><h2 id="工具" tabindex="-1">工具 <a class="header-anchor" href="#工具" aria-label="Permalink to &quot;工具&quot;">​</a></h2><p><a href="https://github.com/acmesh-official/acme.sh" target="_blank" rel="noreferrer">工具 acme.sh github</a></p>`,79)]))}const g=i(l,[["render",t]]);export{c as __pageData,g as default};
