import{j as i,c as a,b as n,ag as e}from"./chunks/framework.BlzMDYBM.js";const o=JSON.parse('{"title":"Redis简介","description":"","frontmatter":{},"headers":[],"relativePath":"linux/redis.md","filePath":"linux/redis.md","lastUpdated":1744879674000}'),l={name:"linux/redis.md"};function p(t,s,h,r,d,k){return n(),a("div",null,s[0]||(s[0]=[e(`<h1 id="redis简介" tabindex="-1">Redis简介 <a class="header-anchor" href="#redis简介" aria-label="Permalink to &quot;Redis简介&quot;">​</a></h1><h2 id="ubuntu安装redis" tabindex="-1">ubuntu安装Redis <a class="header-anchor" href="#ubuntu安装redis" aria-label="Permalink to &quot;ubuntu安装Redis&quot;">​</a></h2><p>更新安装源, 安装编程工具和 <code>tcl</code>.</p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> apt-get</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> update</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> apt-get</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> build-essential</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> tcl</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="下载-redis-源码包" tabindex="-1">下载 redis 源码包 <a class="header-anchor" href="#下载-redis-源码包" aria-label="Permalink to &quot;下载 redis 源码包&quot;">​</a></h3><p>通过 <code>curl</code> 下载最新的 <code>redis</code> 源码压缩文件. 如果没有安装 <code>curl</code> 命令工具, 先安装它.</p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> apt-get</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> -y</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> -O</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> http://download.redis.io/redis-stable.tar.gz</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="解压-redis" tabindex="-1">解压 redis <a class="header-anchor" href="#解压-redis" aria-label="Permalink to &quot;解压 redis&quot;">​</a></h3><p>解压刚刚下载的 <code>redis</code> 安装包.</p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> tar</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> xzvf</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> redis-stable.tar.gz</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="编译-redis" tabindex="-1">编译 redis <a class="header-anchor" href="#编译-redis" aria-label="Permalink to &quot;编译 redis&quot;">​</a></h3><p>进到解压目录中, 使用 <code>make</code> 命令编译 <code>redis</code></p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> cd</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> redis-stable</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> make</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="进行测试" tabindex="-1">进行测试 <a class="header-anchor" href="#进行测试" aria-label="Permalink to &quot;进行测试&quot;">​</a></h3><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> make</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> test</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="redis-安装" tabindex="-1">redis 安装 <a class="header-anchor" href="#redis-安装" aria-label="Permalink to &quot;redis 安装&quot;">​</a></h3><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> make</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> install</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="配置-redis" tabindex="-1">配置 redis <a class="header-anchor" href="#配置-redis" aria-label="Permalink to &quot;配置 redis&quot;">​</a></h3><p>需要要 <code>/etc</code> 目录下创建一个 <code>redis</code> 目录, 用来存储配置文件的.</p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> mkdir</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> /etc/redis</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="复制配置文件" tabindex="-1">复制配置文件 <a class="header-anchor" href="#复制配置文件" aria-label="Permalink to &quot;复制配置文件&quot;">​</a></h3><p>将 <code>redis-stable</code> 目录下中的 <code>redis.conf</code> 默认的配置文件复制到 <code>/etc/redis</code> 目录中</p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> cp</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> redis-stable/redis.conf</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> /etc/redis</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="修改编辑-redis-conf-文件" tabindex="-1">修改编辑 redis.conf 文件 <a class="header-anchor" href="#修改编辑-redis-conf-文件" aria-label="Permalink to &quot;修改编辑 redis.conf 文件&quot;">​</a></h3><p>需要打开 <code>supervised</code> 和设置存储临时数据的目录.</p><p>需要将 <code>supervised</code> 设置为 <code>systemd</code></p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> vim</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> /etc/redis.conf</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;">.</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> .</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> .</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># If you run Redis from upstart or systemd, Redis can interact with your</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># supervision tree. Options:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#   supervised no      - no supervision interaction</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#   supervised upstart - signal upstart by putting Redis into SIGSTOP mode</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#   supervised systemd - signal systemd by writing READY=1 to $NOTIFY_SOCKET</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#   supervised auto    - detect upstart or systemd method based on</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#                        UPSTART_JOB or NOTIFY_SOCKET environment variables</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Note: these supervision methods only signal &quot;process is ready.&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#       They do not enable continuous liveness pings back to your supervisor.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">supervised</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> systemd</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;">.</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> .</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> .</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>下面我们来设置一下临时数据的存储目录为 <code>/var/lib/redis</code>, <code>/var/lib/redis</code> 这是目录需要我们自己去创建.</p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;">.</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> .</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> .</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># The working directory.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># The DB will be written inside this directory, with the filename specified</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># above using the &#39;dbfilename&#39; configuration directive.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># The Append Only File will also be created inside this directory.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Note that you must specify a directory here, not a file name.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">dir</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> /var/lib/redis</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;">.</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> .</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> .</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="创建-systemd-配置文件" tabindex="-1">创建 systemd 配置文件 <a class="header-anchor" href="#创建-systemd-配置文件" aria-label="Permalink to &quot;创建 systemd 配置文件&quot;">​</a></h3><p>需要创建 <code>/etc/systemd/system/redis.service</code> 配置文件.</p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> vim</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> /etc/systemd/system/redis.service</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>编辑内容如下:</p><div class="language-conf vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">conf</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span>[Unit]</span></span>
<span class="line"><span>Description=Redis In-Memory Data Store</span></span>
<span class="line"><span>After=network.target</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[Service]</span></span>
<span class="line"><span>User=redis</span></span>
<span class="line"><span>Group=redis</span></span>
<span class="line"><span>ExecStart=/usr/local/bin/redis-server /etc/redis/redis.conf</span></span>
<span class="line"><span>ExecStop=/usr/local/bin/redis-cli shutdown</span></span>
<span class="line"><span>Restart=always</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[Install]</span></span>
<span class="line"><span>WantedBy=multi-user.target</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="创建-redis-用户-组和目录" tabindex="-1">创建 redis 用户, 组和目录 <a class="header-anchor" href="#创建-redis-用户-组和目录" aria-label="Permalink to &quot;创建 redis 用户, 组和目录&quot;">​</a></h3><p>创建 <code>redis</code> 用户, 这个用户不需要创建用户目录.</p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> adduser</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> --system</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> --group</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> --no-create-home</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> redis</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>创建刚才我们在配置文件中, 使用的 <code>/var/lib/redis</code> 目录.</p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> mkdir</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> /var/lib/redis</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>将 <code>redis</code> 用户和组分配到 <code>/var/lib/redis</code> 目录.</p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> chown</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> redis:redis</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> /var/lib/redis</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> chmod</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> 770</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> /var/lib/redis</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="启动测试-redis-服务" tabindex="-1">启动测试 redis 服务 <a class="header-anchor" href="#启动测试-redis-服务" aria-label="Permalink to &quot;启动测试 redis 服务&quot;">​</a></h3><p>启用 <code>redis</code> 服务</p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> redis</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>查看 <code>redis</code> 服务启动是否成功.</p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> status</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> redis</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>运行下面的命令, 将会有下面的输出信息:</p><div class="language-log vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">log</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">Output</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">● </span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;">redis.service</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;"> - Redis Server</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">   Loaded: loaded (/etc/systemd/system/redis.service; enabled; vendor preset: enabled)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">   Active: active (running) since Wed </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">2016-05-11</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> 14:38:08</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;"> EDT; 1min 43s ago</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">  Process: </span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;">3115</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;"> ExecStop=/usr/local/bin/redis-cli shutdown (code=exited, status=</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">/SUCCESS)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#24292E;"> Main PID: </span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;">3124</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;"> (redis-server)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">    Tasks: </span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;"> (limit: </span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;">512</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">   Memory: </span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;">864</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">.0K</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">      CPU: 179ms</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">   CGroup: /system.slice/redis.service</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">           └─</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;">3124</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;"> /usr/local/bin/redis-server </span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;">127</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;">6379</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">       </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">. . .</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="redis-命令行工具" tabindex="-1">redis 命令行工具 <a class="header-anchor" href="#redis-命令行工具" aria-label="Permalink to &quot;redis 命令行工具&quot;">​</a></h3><p>可以使用命令行工具, 连接 <code>redis</code></p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> redis-cli</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span>127.0.0.1:6379&gt; info</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="nodejs-使用-redis" tabindex="-1">nodejs 使用 redis <a class="header-anchor" href="#nodejs-使用-redis" aria-label="Permalink to &quot;nodejs 使用 redis&quot;">​</a></h2><p>先要使用 <code>express -e</code> 创建项目, 并使用 <code>npm</code> 命令安装<code>nodejs</code>模块.</p><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> express</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> -e</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> redis-node</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> cd</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> redis-node</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> npm</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> install</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>需要安装 <code>nodejs</code> 的 <code>redis</code> 库文件.</p><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> npm</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> i</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> redis</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> --save</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>在当前项目下创建 <code>redis</code> 目录, 并在目录下创建 <code>index.js</code> 文件. (当前目录在 <code>redis</code> 项目目录.)</p><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> mkdir</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> redis</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> cd</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> redis</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> touch</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> index.js</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>我们现在需要编写代码, 连接 <code>redis</code> 服务器.</p><p>下面是 <code>redis/index.js</code> 文件内容.</p><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#D73A49;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> redis</span><span style="--shiki-light:#D73A49;--shiki-dark:#D73A49;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;">&#39;redis&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#D73A49;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> client</span><span style="--shiki-light:#D73A49;--shiki-dark:#D73A49;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;"> redis.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">createClient</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">  host: </span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;">&#39;redis-13302.c14.us-east-1-2.ec2.cloud.redislabs.com&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">  port: </span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;">13302</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">  password:</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;">&#39;asdfgh&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">client.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;">&#39;connect&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">,(</span><span style="--shiki-light:#E36209;--shiki-dark:#E36209;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#D73A49;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#D73A49;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">(err){</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;">&#39;Redis connect error&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">(err);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">  }</span><span style="--shiki-light:#D73A49;--shiki-dark:#D73A49;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;">&#39;Redis connect OK&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;">exports</span><span style="--shiki-light:#D73A49;--shiki-dark:#D73A49;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;"> client;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h1 id="redis-install-conter-os" tabindex="-1">Redis install conter os <a class="header-anchor" href="#redis-install-conter-os" aria-label="Permalink to &quot;Redis install conter os&quot;">​</a></h1><p>In this section you’ll add the EPEL repository, and then use it to install Redis.</p><p>Add the EPEL repository, and update YUM to confirm your change:</p><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> yum</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> epel-release</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> yum</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> update</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Install Redis:</p><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> yum</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> redis</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Start Redis:</p><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> redis</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Show Redis status:</p><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> status</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> redis</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Optional: To automatically start Redis on boot:</p><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> enable</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> redis</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Verify the Installation Verify that Redis is running with redis-cli:</p><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">redis-cli</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> -h</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> 127.0.0.1</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> -p</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> 6379</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h5 id="构建redis服务器-512m" tabindex="-1">构建Redis服务器 [512M] <a class="header-anchor" href="#构建redis服务器-512m" aria-label="Permalink to &quot;构建Redis服务器 [512M]&quot;">​</a></h5><p>配置<code>redis</code>文件如下:</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span>sudo vim /etc/redis.conf</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h5 id="redis-conf" tabindex="-1">redis.conf <a class="header-anchor" href="#redis-conf" aria-label="Permalink to &quot;redis.conf&quot;">​</a></h5><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">参</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 设置最大使用内存 512MB</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">maxmemory</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> 512mb</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 设置客户端最多连接数量</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">maxclients</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> 128</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># bind</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">bind</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> 0.0.0.0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 首先将 daemonize 由 no 改成 yes，表示允许 Redis 在后台启动</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">daemonize</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> yes</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 设置密码</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">requirepass</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> b840fc02d52404</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># protected-mode 设置为 no 关闭保护模式</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">protected-mode</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> yes</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h5 id="使用客户端连接redis" tabindex="-1">使用客户端连接redis. <a class="header-anchor" href="#使用客户端连接redis" aria-label="Permalink to &quot;使用客户端连接redis.&quot;">​</a></h5><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> redis-cli</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> -h</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> redis.edms.site</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> -a</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> b840fc02d52404</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">redis.edms.site:6379</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;">info</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">redis.edms.site:6379</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">&gt; </span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;">exit</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="参考文档" tabindex="-1">参考文档 <a class="header-anchor" href="#参考文档" aria-label="Permalink to &quot;参考文档&quot;">​</a></h2><ul><li><a href="https://www.digitalocean.com/community/tutorials/how-to-install-and-configure-redis-on-ubuntu-16-04" target="_blank" rel="noreferrer">ubuntu1604安装配置redis</a></li></ul><h1 id="ubuntu-20-04-上安装-redis" tabindex="-1">Ubuntu 20.04 上安装 Redis <a class="header-anchor" href="#ubuntu-20-04-上安装-redis" aria-label="Permalink to &quot;Ubuntu 20.04 上安装 Redis&quot;">​</a></h1><h3 id="直接安装-redis" tabindex="-1">直接安装 Redis <a class="header-anchor" href="#直接安装-redis" aria-label="Permalink to &quot;直接安装 Redis&quot;">​</a></h3><p>在 Ubuntu 上安装 Redis 非常简单直接。</p><p>Redis 5.0 被包含在默认的 Ubuntu 20.04 软件源中。想要安装它，以 root 或者其他 sudo 身份运行下面的命令：</p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> update</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> redis-server</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>一旦安装完成，Redis 服务将会自动启动。想要检查服务的状态，输入下面的命令：</p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> status</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> redis-server</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>你应该看到下面这些：</p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">●</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> redis-server.service</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> -</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> Advanced</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> key-value</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> store</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">     Loaded:</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> loaded</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;"> (/lib/systemd/system/redis-server.service; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">enabled</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">vendor</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> preset:</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> enabled</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">     Active:</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> active</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;"> (running) since Sat 2020-06-06 20:03:08 UTC; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">10s</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> ago</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;">...</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>如果你的服务器上禁用 IPv6，那么 Redis 服务将会启动失败。 就这些。你已经在你的 Ubuntu 20.04 上安装并运行了 Redis。</p><h3 id="配置-redis-远程访问" tabindex="-1">配置 Redis 远程访问 <a class="header-anchor" href="#配置-redis-远程访问" aria-label="Permalink to &quot;配置 Redis 远程访问&quot;">​</a></h3><p>默认情况下，Redis 不允许远程连接。你仅仅只能从127.0.0.1（localhost）连接 Redis 服务器 - Redis 服务器正在运行的机器上。</p><p>如果你正在使用单机，数据库也同样在这台机器上，你不需要启用远程访问。</p><p>想要配置 Redis 来接受远程访问，使用你的文本编辑器打开 Redis 配置文件：</p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> nano</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> /etc/redis.conf</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>定位到以bind 127.0.0.1 ::1开头的一行，并且取消它的注释：</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span># bind 0.0.0.0 ::1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>如果你的服务器有局域网 IP，并且你想要 Redis 从局域网可以访问 Redis，在这一行后面加上服务器局域网 IP 地址。 保存这个文件，并且重启 Redis 服务，使应用生效：</p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> redis-server</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>使用下面的命令来验证 Redis 服务器正在监听端口6379：</p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">ss</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> -an</span><span style="--shiki-light:#D73A49;--shiki-dark:#D73A49;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;"> grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> 6379</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>你应该能看到类似下面的信息：</p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">tcp</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;">  LISTEN</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> 0</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;">   511</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;">   0.0.0.0:6379</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;">   0.0.0.0:</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;">*</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">tcp</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;">  LISTEN</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> 0</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;">   511</span><span style="--shiki-light:#24292E;--shiki-dark:#24292E;">      [::]:6379      [::]:</span><span style="--shiki-light:#D73A49;--shiki-dark:#D73A49;">*</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>下一步，你将需要配置你的防火墙，允许网络流量通过 TCP 端口6379。</p><p>通常你想要允许从一个指定 IP 地址或者一个指定 IP 范围来访问 Redis 服务器。例如，想要允许从192.168.121.0/24的连接，运行下面的命令：</p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> ufw</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> allow</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> proto</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> tcp</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> 192.168.121.0/24</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> any</span><span style="--shiki-light:#032F62;--shiki-dark:#032F62;"> port</span><span style="--shiki-light:#005CC5;--shiki-dark:#005CC5;"> 6379</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>确保你的防火墙被配置仅仅接受来自受信任 IP 的连接。 此时，你应该可以从远程位置通过 TCP 连接到 Redis 的 6379 端口。</p><p>想要验证所有设置都设置好了，你可以尝试使用redis-cli从你的远程机器上 ping 一下 Redis 服务器。</p><div class="language-redis vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">redis</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span>redis-cli -h &lt;REDIS_IP_ADDRESS&gt; ping</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>这个命令将会返回一个响应：PONG</p><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-light vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#6F42C1;">PONG</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div>`,116)]))}const g=i(l,[["render",p]]);export{o as __pageData,g as default};
